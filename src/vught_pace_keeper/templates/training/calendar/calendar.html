{% extends "base.html" %}

{% block title %}Training Calendar - Vught Pace Keeper{% endblock %}

{% block content %}
<div class="mb-6">
    <h1 class="text-2xl font-bold text-gray-900">Training Calendar</h1>
    <p class="text-gray-600 mt-1">View your planned and completed workouts</p>
</div>

<!-- Calendar Container -->
<div id="calendar-container">
    {% include "training/calendar/partials/month_view.html" %}
</div>

<!-- Day Detail Modal -->
<div id="day-modal"
     class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center"
     onclick="if(event.target === this) closeModal()">
    <div id="day-modal-content" class="bg-white rounded-lg shadow-xl max-w-lg w-full mx-4 max-h-[90vh] overflow-y-auto">
        <!-- Content loaded via HTMX -->
    </div>
</div>

<!-- Legend -->
<div class="mt-6 card">
    <h3 class="text-sm font-semibold text-gray-700 mb-3">Legend</h3>
    <div class="flex flex-wrap gap-4 text-sm">
        <div class="flex items-center gap-2">
            <span class="w-3 h-3 rounded-full bg-green-500"></span>
            <span>Completed</span>
        </div>
        <div class="flex items-center gap-2">
            <span class="w-3 h-3 rounded-full bg-yellow-500"></span>
            <span>Partial</span>
        </div>
        <div class="flex items-center gap-2">
            <span class="w-3 h-3 rounded-full bg-red-500"></span>
            <span>Missed</span>
        </div>
        <div class="flex items-center gap-2">
            <span class="w-3 h-3 rounded-full bg-blue-500"></span>
            <span>Planned</span>
        </div>
        <div class="flex items-center gap-2">
            <span class="w-3 h-3 rounded-full bg-gray-300"></span>
            <span>Rest</span>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
function openModal() {
    document.getElementById('day-modal').classList.remove('hidden');
    document.body.style.overflow = 'hidden';
}

function closeModal() {
    document.getElementById('day-modal').classList.add('hidden');
    document.body.style.overflow = '';
}

// Handle escape key
document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
        closeModal();
    }
});

// Open modal when content is loaded via HTMX
document.body.addEventListener('htmx:afterSwap', function(evt) {
    if (evt.detail.target.id === 'day-modal-content') {
        openModal();
    }
});
</script>
{% endblock %}
